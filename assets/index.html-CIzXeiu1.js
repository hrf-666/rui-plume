import{_ as a}from"./3.哨兵架构-CBtGluOK.js";import{_ as m,c as l,b as n,o as e}from"./app-BxaswAnj.js";const t="/rui-plume/assets/4.sentinel.conf%E7%9B%AE%E5%BD%95%E5%9C%B0%E5%9D%80-BnLOoIxj.png",r="/rui-plume/assets/5.quorum%E7%A5%A8%E6%95%B0%E8%A7%A3%E9%87%8A-DAbXJOhA.png",i={};function o(p,s){return e(),l("div",null,[...s[0]||(s[0]=[n('<h1 id="配置参数说明" tabindex="-1"><a class="header-anchor" href="#配置参数说明"><span>配置参数说明</span></a></h1><h3 id="redis-sentinel架构-前提说明" tabindex="-1"><a class="header-anchor" href="#redis-sentinel架构-前提说明"><span>Redis Sentinel架构，前提说明</span></a></h3><ul><li>3个哨兵：自动监控和维护集群，不存放数据，只是吹哨人</li><li>1主2从：用于数据读取和存放</li></ul><p><img src="'+a+'" alt=""></p><h3 id="操作步骤" tabindex="-1"><a class="header-anchor" href="#操作步骤"><span>操作步骤</span></a></h3><ol><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi mathvariant="normal">/</mi><mi>m</mi><mi>y</mi><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>s</mi><mtext>目录下新建或者拷贝</mtext><mi>s</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>l</mi><mi mathvariant="normal">.</mi><mi>c</mi><mi>o</mi><mi>n</mi><mi>f</mi><mtext>文件按，名字绝对不能错</mtext></mstyle></mrow><annotation encoding="application/x-tex">\\textcolor{red}{/myredis目录下新建或者拷贝sentinel.conf文件按，名字绝对不能错}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord" style="color:red;">/</span><span class="mord mathnormal" style="color:red;">m</span><span class="mord mathnormal" style="color:red;">yre</span><span class="mord mathnormal" style="color:red;">d</span><span class="mord mathnormal" style="color:red;">i</span><span class="mord mathnormal" style="color:red;">s</span><span class="mord cjk_fallback" style="color:red;">目录下新建或者拷贝</span><span class="mord mathnormal" style="color:red;">se</span><span class="mord mathnormal" style="color:red;">n</span><span class="mord mathnormal" style="color:red;">t</span><span class="mord mathnormal" style="color:red;">in</span><span class="mord mathnormal" style="color:red;">e</span><span class="mord mathnormal" style="margin-right:0.01968em;color:red;">l</span><span class="mord" style="color:red;">.</span><span class="mord mathnormal" style="color:red;">co</span><span class="mord mathnormal" style="color:red;">n</span><span class="mord mathnormal" style="margin-right:0.10764em;color:red;">f</span><span class="mord cjk_fallback" style="color:red;">文件按，名字绝对不能错</span></span></span></span></p></li><li><p>先看看/opt目录下默认的sentinel.conf文件的内容</p><p><img src="'+t+'" alt=""></p></li><li><p>重要参数项说明</p><ul><li><p>bind：服务监听地址，用于客户端连接，默认本机地址</p></li><li><p>daemonize：是否以后台daemon方式运行</p></li><li><p>protected-model：安全保护模式</p></li><li><p>port：端口</p></li><li><p>logfile：日志文件路径</p></li><li><p>pidfile：pid文件路径</p></li><li><p>dir：工作目录</p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>s</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>l</mi><mtext> </mtext><mi>m</mi><mi>o</mi><mi>n</mi><mi>i</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo>&lt;</mo><mi>m</mi><mi>a</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo>−</mo><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>&gt;</mo><mo>&lt;</mo><mi>i</mi><mi>p</mi><mo>&gt;</mo><mo>&lt;</mo><mi>r</mi><mi>e</mi><mi>d</mi><mi>i</mi><mi>s</mi><mo>−</mo><mi>p</mi><mi>o</mi><mi>r</mi><mi>t</mi><mo>&gt;</mo><mo>&lt;</mo><mi>q</mi><mi>u</mi><mi>o</mi><mi>r</mi><mi>u</mi><mi>m</mi><mo>&gt;</mo></mstyle></mrow><annotation encoding="application/x-tex">\\textcolor{red}{sentinel\\ monitor &lt;master-name&gt; &lt;ip&gt; &lt;redis-port&gt; &lt;quorum&gt;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="color:red;">se</span><span class="mord mathnormal" style="color:red;">n</span><span class="mord mathnormal" style="color:red;">t</span><span class="mord mathnormal" style="color:red;">in</span><span class="mord mathnormal" style="color:red;">e</span><span class="mord mathnormal" style="margin-right:0.01968em;color:red;">l</span><span class="mspace" style="color:red;"><span style="color:red;"> </span></span><span class="mord mathnormal" style="color:red;">m</span><span class="mord mathnormal" style="color:red;">o</span><span class="mord mathnormal" style="color:red;">ni</span><span class="mord mathnormal" style="color:red;">t</span><span class="mord mathnormal" style="margin-right:0.02778em;color:red;">or</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:red;">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="color:red;">ma</span><span class="mord mathnormal" style="color:red;">s</span><span class="mord mathnormal" style="color:red;">t</span><span class="mord mathnormal" style="margin-right:0.02778em;color:red;">er</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:red;">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="color:red;">nam</span><span class="mord mathnormal" style="color:red;">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:red;">&gt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="color:red;">i</span><span class="mord mathnormal" style="color:red;">p</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:red;">&gt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="color:red;">re</span><span class="mord mathnormal" style="color:red;">d</span><span class="mord mathnormal" style="color:red;">i</span><span class="mord mathnormal" style="color:red;">s</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:red;">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="color:red;">p</span><span class="mord mathnormal" style="margin-right:0.02778em;color:red;">or</span><span class="mord mathnormal" style="color:red;">t</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:red;">&gt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;color:red;">q</span><span class="mord mathnormal" style="color:red;">u</span><span class="mord mathnormal" style="margin-right:0.02778em;color:red;">or</span><span class="mord mathnormal" style="color:red;">u</span><span class="mord mathnormal" style="color:red;">m</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:red;">&gt;</span></span></span></span></p><p>设置要监控的master服务器</p><p>quorum表示最少有几个哨兵认可客观下线，同意故障迁移的法定票数</p><p><img src="'+r+`" alt=""></p><p>网络是不可靠的有时候一个sentinel会因为网络堵塞而误以为master redis已经死掉，在sentinel集群环境下需要多个sentinel互相沟通来确认某个master是否真的死掉了，quorum这个参数是进行客观下线的一个依据，意思是至少有quorum个sentinel认为这个master有故障，才会对这个master进行下线以及故障转移。因为有的时候，某个sentinel节点可能因为自身网络原因，导致无法连接master，而此时master并没有出现故障，所以，这就需要多个sentinel都一致认为改master有问题，才可以进行下一步操作，这就保证了公平性和高可用。</p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mi>s</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>l</mi><mtext> </mtext><mi>a</mi><mi>u</mi><mi>t</mi><mi>h</mi><mo>−</mo><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mo>&lt;</mo><mi>m</mi><mi>a</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>r</mi><mo>−</mo><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>&gt;</mo><mo>&lt;</mo><mi>p</mi><mi>a</mi><mi>s</mi><mi>s</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>d</mi><mo>&gt;</mo></mstyle></mrow><annotation encoding="application/x-tex">\\textcolor{red}{sentinel\\ auth-pass &lt;master-name&gt; &lt;password&gt;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="color:red;">se</span><span class="mord mathnormal" style="color:red;">n</span><span class="mord mathnormal" style="color:red;">t</span><span class="mord mathnormal" style="color:red;">in</span><span class="mord mathnormal" style="color:red;">e</span><span class="mord mathnormal" style="margin-right:0.01968em;color:red;">l</span><span class="mspace" style="color:red;"><span style="color:red;"> </span></span><span class="mord mathnormal" style="color:red;">a</span><span class="mord mathnormal" style="color:red;">u</span><span class="mord mathnormal" style="color:red;">t</span><span class="mord mathnormal" style="color:red;">h</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:red;">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="color:red;">p</span><span class="mord mathnormal" style="color:red;">a</span><span class="mord mathnormal" style="color:red;">ss</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:red;">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6984em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="color:red;">ma</span><span class="mord mathnormal" style="color:red;">s</span><span class="mord mathnormal" style="color:red;">t</span><span class="mord mathnormal" style="margin-right:0.02778em;color:red;">er</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:red;">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="color:red;">nam</span><span class="mord mathnormal" style="color:red;">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:red;">&gt;&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="color:red;">p</span><span class="mord mathnormal" style="color:red;">a</span><span class="mord mathnormal" style="color:red;">ss</span><span class="mord mathnormal" style="margin-right:0.02691em;color:red;">w</span><span class="mord mathnormal" style="margin-right:0.02778em;color:red;">or</span><span class="mord mathnormal" style="color:red;">d</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel" style="color:red;">&gt;</span></span></span></span></p><p>master设置了密码，连接master服务的密码</p></li><li><p>其他</p></li></ul></li></ol><div class="language-text line-numbers-mode" data-highlighter="shiki" data-ext="text" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code class="language-text"><span class="line"><span>     | sentinel down-after-milliseconds &lt;master-name&gt;  &lt;milliseconds/&gt; | 指定多少毫秒之后，主节点没有应答哨兵，此时哨兵主观上认为主节点下线        |</span></span>
<span class="line"><span>     |-----------------------------------------------------------------| ---------------------------------------- |</span></span>
<span class="line"><span>     | sentinel parallel-syncs &lt;master-name&gt; &lt;nums&gt;                    | 表示允许并行同步的slave个数，当Master挂了后，哨兵会选出新的Master，此时，剩余的slave会向新的master发起同步数据 |</span></span>
<span class="line"><span>     | sentinel failover-timeout &lt;master-name&gt; &lt;milliseconds/&gt;         | 故障转移的超时时间，进行故障转移时，如果超过设置的毫秒，表示故障转移失败     |</span></span>
<span class="line"><span>     | sentinel notification-script &lt;master-name&gt; &lt;script-path&gt;        | 配置当某一事件发生时所需要执行的脚本                       |</span></span>
<span class="line"><span>     | sentinel client-reconfig-script &lt;master-name&gt; &lt;script-path&gt;     | 客户端重新配置主节点参数脚本                           |</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,7)])])}const h=m(i,[["render",o]]),g=JSON.parse('{"path":"/article/z3wki1bh/","title":"2.sentinel配置参数说明","lang":"zh-CN","frontmatter":{"title":"2.sentinel配置参数说明","createTime":"2025/08/25 22:29:43","permalink":"/article/z3wki1bh/","watermark":true},"readingTime":{"minutes":2.1,"words":629},"git":{"createdTime":1756136329000,"updatedTime":1756180236000,"contributors":[{"name":"HRF","username":"HRF","email":"3398775460@qq.com","commits":2,"avatar":"https://avatars.githubusercontent.com/HRF?v=4","url":"https://github.com/HRF"}]},"filePathRelative":"study-notes/back-end/redis/9.Redis哨兵(sentinel)/2.sentinel配置参数说明.md","headers":[],"categoryList":[{"id":"3c4c90","sort":10002,"name":"study-notes"},{"id":"fe643d","sort":10003,"name":"back-end"},{"id":"46b09b","sort":10033,"name":"redis"},{"id":"a9eb91","sort":9,"name":"Redis哨兵(sentinel)"}]}');export{h as comp,g as data};

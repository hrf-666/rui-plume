import{_ as a,c as r,b as m,a as l,o as e}from"./app-BxaswAnj.js";const n="/rui-plume/assets/15.sentinel%E9%80%89%E4%B8%BE-Cft7hoOM.png",t="/rui-plume/assets/16.%E6%97%A7master%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E9%87%8D%E5%86%99-BkKu455U.jpg",o="/rui-plume/assets/17.slave%E5%8D%87master%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E9%87%8D%E5%86%99-CFfX3OC5.jpg",c="/rui-plume/assets/18.%E5%A4%9Amaster%E7%9B%91%E6%8E%A7-wsEfyDKJ.jpg",i={};function d(p,s){return e(),r("div",null,[...s[0]||(s[0]=[m('<h1 id="主节点异常情况" tabindex="-1"><a class="header-anchor" href="#主节点异常情况"><span>主节点异常情况</span></a></h1><h3 id="原有的master挂了" tabindex="-1"><a class="header-anchor" href="#原有的master挂了"><span>原有的master挂了</span></a></h3><ul><li><p>我们自己手动关闭6379服务器，模拟master挂了</p></li><li><p>问题思考</p><ol><li>两台从机数据是否OK</li><li>是否会从剩下的2台机器上选出新的master</li><li>之前down机的master机器重启回来，谁将会是新老大？会不会双master冲突</li></ol></li><li><p>揭晓答案</p><ol><li><p>两台从机数据OK</p><p>![](images/14.Broken Pipe.png)</p></li><li><p>会投票选出新的master主机</p><p><img src="'+n+'" alt=""></p></li><li><p>谁是master，限本次案例</p><p>本案例中6381被选举为新的master，上位成功</p><p>重启6379之后，它会从原来的master降级为slave</p><p>6380还是slave，只不过是换了一个新老大6381(从跟随6379变成跟随6381)</p></li></ol></li></ul><h3 id="对比配置文件" tabindex="-1"><a class="header-anchor" href="#对比配置文件"><span>对比配置文件</span></a></h3><p>老master的redis6379.conf文件</p><p><img src="'+t+'" alt=""></p><p>新master的redis6381.conf文件</p><p><img src="'+o+'" alt=""></p><h3 id="结论" tabindex="-1"><a class="header-anchor" href="#结论"><span>结论</span></a></h3><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mtext>文件的内容，在运行期间会被</mtext><mi>s</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>l</mi><mtext>动态进行更改</mtext></mstyle></mrow><annotation encoding="application/x-tex">\\textcolor{red}{文件的内容，在运行期间会被sentinel动态进行更改}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord cjk_fallback" style="color:red;">文件的内容，在运行期间会被</span><span class="mord mathnormal" style="color:red;">se</span><span class="mord mathnormal" style="color:red;">n</span><span class="mord mathnormal" style="color:red;">t</span><span class="mord mathnormal" style="color:red;">in</span><span class="mord mathnormal" style="color:red;">e</span><span class="mord mathnormal" style="margin-right:0.01968em;color:red;">l</span><span class="mord cjk_fallback" style="color:red;">动态进行更改</span></span></span></span></p>',10),l("p",null,[l("span",{class:"katex"},[l("span",{class:"katex-mathml"},[l("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[l("semantics",null,[l("mrow",null,[l("mstyle",{mathcolor:"red"},[l("mi",null,"M"),l("mi",null,"a"),l("mi",null,"s"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r"),l("mo",null,"−"),l("mi",null,"S"),l("mi",null,"l"),l("mi",null,"a"),l("mi",null,"v"),l("mi",null,"e"),l("mtext",null,"切换后，"),l("mi",null,"m"),l("mi",null,"a"),l("mi",null,"s"),l("mi",null,"t"),l("mi",null,"e"),l("msub",null,[l("mi",null,"r"),l("mi",null,"r")]),l("mi",null,"e"),l("mi",null,"d"),l("mi",null,"i"),l("mi",null,"s"),l("mi",{mathvariant:"normal"},"."),l("mi",null,"c"),l("mi",null,"o"),l("mi",null,"n"),l("mi",null,"f"),l("mtext",null,"、"),l("mi",null,"s"),l("mi",null,"l"),l("mi",null,"a"),l("mi",null,"v"),l("msub",null,[l("mi",null,"e"),l("mi",null,"r")]),l("mi",null,"e"),l("mi",null,"d"),l("mi",null,"i"),l("mi",null,"s"),l("mi",{mathvariant:"normal"},"."),l("mi",null,"c"),l("mi",null,"o"),l("mi",null,"n"),l("mi",null,"f"),l("mtext",null,"、"),l("mi",null,"s"),l("mi",null,"e"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"e"),l("mi",null,"l"),l("mi",{mathvariant:"normal"},"."),l("mi",null,"c"),l("mi",null,"o"),l("mi",null,"n"),l("mi",null,"f"),l("mtext",null,"的内容都会发生改"),l("mspace",{linebreak:"newline"}),l("mtext",null,"变，即"),l("mi",null,"m"),l("mi",null,"a"),l("mi",null,"s"),l("mi",null,"t"),l("mi",null,"e"),l("msub",null,[l("mi",null,"r"),l("mi",null,"r")]),l("mi",null,"e"),l("mi",null,"d"),l("mi",null,"i"),l("mi",null,"s"),l("mi",{mathvariant:"normal"},"."),l("mi",null,"c"),l("mi",null,"o"),l("mi",null,"n"),l("mi",null,"f"),l("mtext",null,"中会多一行"),l("mi",null,"s"),l("mi",null,"l"),l("mi",null,"a"),l("mi",null,"v"),l("mi",null,"e"),l("mi",null,"o"),l("mi",null,"f"),l("mtext",null,"的配置，而升级为"),l("mi",null,"m"),l("mi",null,"a"),l("mi",null,"s"),l("mi",null,"t"),l("mi",null,"e"),l("mi",null,"r"),l("mtext",null,"的主机会去掉原来的"),l("mi",null,"s"),l("mi",null,"l"),l("mi",null,"a"),l("mi",null,"v"),l("mi",null,"e"),l("mi",null,"o"),l("mi",null,"f"),l("mtext",null,"配置，"),l("mspace",{linebreak:"newline"}),l("mi",null,"s"),l("mi",null,"e"),l("mi",null,"n"),l("mi",null,"t"),l("mi",null,"i"),l("mi",null,"n"),l("mi",null,"e"),l("mi",null,"l"),l("mi",{mathvariant:"normal"},"."),l("mi",null,"c"),l("mi",null,"o"),l("mi",null,"n"),l("mi",null,"f"),l("mtext",null,"的监控目标会随之调换")])]),l("annotation",{encoding:"application/x-tex"},"\\textcolor{red}{Master-Slave切换后，master_redis.conf、slave_redis.conf、sentinel.conf的内容都会发生改\\\\变，即master_redis.conf中会多一行slaveof的配置，而升级为master的主机会去掉原来的slaveof配置，\\\\sentinel.conf的监控目标会随之调换}")])])]),l("span",{class:"katex-html","aria-hidden":"true"},[l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.7667em","vertical-align":"-0.0833em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em",color:"red"}},"M"),l("span",{class:"mord mathnormal",style:{color:"red"}},"a"),l("span",{class:"mord mathnormal",style:{color:"red"}},"s"),l("span",{class:"mord mathnormal",style:{color:"red"}},"t"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em",color:"red"}},"er"),l("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),l("span",{class:"mbin",style:{color:"red"}},"−"),l("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),l("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em",color:"red"}},"Sl"),l("span",{class:"mord mathnormal",style:{color:"red"}},"a"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em",color:"red"}},"v"),l("span",{class:"mord mathnormal",style:{color:"red"}},"e"),l("span",{class:"mord cjk_fallback",style:{color:"red"}},"切换后，"),l("span",{class:"mord mathnormal",style:{color:"red"}},"ma"),l("span",{class:"mord mathnormal",style:{color:"red"}},"s"),l("span",{class:"mord mathnormal",style:{color:"red"}},"t"),l("span",{class:"mord mathnormal",style:{color:"red"}},"e"),l("span",{class:"mord",style:{color:"red"}},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em",color:"red"}},"r"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.1514em"}},[l("span",{style:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight",style:{color:"red"}},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em",color:"red"}},"r")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mord mathnormal",style:{color:"red"}},"e"),l("span",{class:"mord mathnormal",style:{color:"red"}},"d"),l("span",{class:"mord mathnormal",style:{color:"red"}},"i"),l("span",{class:"mord mathnormal",style:{color:"red"}},"s"),l("span",{class:"mord",style:{color:"red"}},"."),l("span",{class:"mord mathnormal",style:{color:"red"}},"co"),l("span",{class:"mord mathnormal",style:{color:"red"}},"n"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em",color:"red"}},"f"),l("span",{class:"mord cjk_fallback",style:{color:"red"}},"、"),l("span",{class:"mord mathnormal",style:{color:"red"}},"s"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em",color:"red"}},"l"),l("span",{class:"mord mathnormal",style:{color:"red"}},"a"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em",color:"red"}},"v"),l("span",{class:"mord",style:{color:"red"}},[l("span",{class:"mord mathnormal",style:{color:"red"}},"e"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.1514em"}},[l("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight",style:{color:"red"}},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em",color:"red"}},"r")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mord mathnormal",style:{color:"red"}},"e"),l("span",{class:"mord mathnormal",style:{color:"red"}},"d"),l("span",{class:"mord mathnormal",style:{color:"red"}},"i"),l("span",{class:"mord mathnormal",style:{color:"red"}},"s"),l("span",{class:"mord",style:{color:"red"}},"."),l("span",{class:"mord mathnormal",style:{color:"red"}},"co"),l("span",{class:"mord mathnormal",style:{color:"red"}},"n"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em",color:"red"}},"f"),l("span",{class:"mord cjk_fallback",style:{color:"red"}},"、"),l("span",{class:"mord mathnormal",style:{color:"red"}},"se"),l("span",{class:"mord mathnormal",style:{color:"red"}},"n"),l("span",{class:"mord mathnormal",style:{color:"red"}},"t"),l("span",{class:"mord mathnormal",style:{color:"red"}},"in"),l("span",{class:"mord mathnormal",style:{color:"red"}},"e"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em",color:"red"}},"l"),l("span",{class:"mord",style:{color:"red"}},"."),l("span",{class:"mord mathnormal",style:{color:"red"}},"co"),l("span",{class:"mord mathnormal",style:{color:"red"}},"n"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em",color:"red"}},"f"),l("span",{class:"mord cjk_fallback",style:{color:"red"}},"的内容都会发生改")]),l("span",{class:"mspace newline",style:{color:"red"}}),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),l("span",{class:"mord cjk_fallback",style:{color:"red"}},"变，即"),l("span",{class:"mord mathnormal",style:{color:"red"}},"ma"),l("span",{class:"mord mathnormal",style:{color:"red"}},"s"),l("span",{class:"mord mathnormal",style:{color:"red"}},"t"),l("span",{class:"mord mathnormal",style:{color:"red"}},"e"),l("span",{class:"mord",style:{color:"red"}},[l("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em",color:"red"}},"r"),l("span",{class:"msupsub"},[l("span",{class:"vlist-t vlist-t2"},[l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.1514em"}},[l("span",{style:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[l("span",{class:"pstrut",style:{height:"2.7em"}}),l("span",{class:"sizing reset-size6 size3 mtight",style:{color:"red"}},[l("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em",color:"red"}},"r")])])]),l("span",{class:"vlist-s"},"​")]),l("span",{class:"vlist-r"},[l("span",{class:"vlist",style:{height:"0.15em"}},[l("span")])])])])]),l("span",{class:"mord mathnormal",style:{color:"red"}},"e"),l("span",{class:"mord mathnormal",style:{color:"red"}},"d"),l("span",{class:"mord mathnormal",style:{color:"red"}},"i"),l("span",{class:"mord mathnormal",style:{color:"red"}},"s"),l("span",{class:"mord",style:{color:"red"}},"."),l("span",{class:"mord mathnormal",style:{color:"red"}},"co"),l("span",{class:"mord mathnormal",style:{color:"red"}},"n"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em",color:"red"}},"f"),l("span",{class:"mord cjk_fallback",style:{color:"red"}},"中会多一行"),l("span",{class:"mord mathnormal",style:{color:"red"}},"s"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em",color:"red"}},"l"),l("span",{class:"mord mathnormal",style:{color:"red"}},"a"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em",color:"red"}},"v"),l("span",{class:"mord mathnormal",style:{color:"red"}},"eo"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em",color:"red"}},"f"),l("span",{class:"mord cjk_fallback",style:{color:"red"}},"的配置，而升级为"),l("span",{class:"mord mathnormal",style:{color:"red"}},"ma"),l("span",{class:"mord mathnormal",style:{color:"red"}},"s"),l("span",{class:"mord mathnormal",style:{color:"red"}},"t"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em",color:"red"}},"er"),l("span",{class:"mord cjk_fallback",style:{color:"red"}},"的主机会去掉原来的"),l("span",{class:"mord mathnormal",style:{color:"red"}},"s"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em",color:"red"}},"l"),l("span",{class:"mord mathnormal",style:{color:"red"}},"a"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em",color:"red"}},"v"),l("span",{class:"mord mathnormal",style:{color:"red"}},"eo"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em",color:"red"}},"f"),l("span",{class:"mord cjk_fallback",style:{color:"red"}},"配置，")]),l("span",{class:"mspace newline",style:{color:"red"}}),l("span",{class:"base"},[l("span",{class:"strut",style:{height:"0.8889em","vertical-align":"-0.1944em"}}),l("span",{class:"mord mathnormal",style:{color:"red"}},"se"),l("span",{class:"mord mathnormal",style:{color:"red"}},"n"),l("span",{class:"mord mathnormal",style:{color:"red"}},"t"),l("span",{class:"mord mathnormal",style:{color:"red"}},"in"),l("span",{class:"mord mathnormal",style:{color:"red"}},"e"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em",color:"red"}},"l"),l("span",{class:"mord",style:{color:"red"}},"."),l("span",{class:"mord mathnormal",style:{color:"red"}},"co"),l("span",{class:"mord mathnormal",style:{color:"red"}},"n"),l("span",{class:"mord mathnormal",style:{"margin-right":"0.10764em",color:"red"}},"f"),l("span",{class:"mord cjk_fallback",style:{color:"red"}},"的监控目标会随之调换")])])])],-1),l("h3",{id:"其他备注",tabindex:"-1"},[l("a",{class:"header-anchor",href:"#其他备注"},[l("span",null,"其他备注")])],-1),l("p",null,"生产上都是不同机房不同服务器，很少出现3个哨兵全部挂掉的情况",-1),l("p",null,"可以同时金童多个master，一行一个",-1),l("p",null,[l("img",{src:c,alt:""})],-1)])])}const u=a(i,[["render",d]]),y=JSON.parse('{"path":"/article/p1exwf5j/","title":"4.哨兵监控节点异常","lang":"zh-CN","frontmatter":{"title":"4.哨兵监控节点异常","createTime":"2025/08/25 22:29:43","permalink":"/article/p1exwf5j/","watermark":true},"readingTime":{"minutes":1.24,"words":372},"git":{"createdTime":1756136329000,"updatedTime":1756136329000,"contributors":[{"name":"HRF","username":"HRF","email":"3398775460@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/HRF?v=4","url":"https://github.com/HRF"}]},"filePathRelative":"study-notes/back-end/redis/9.Redis哨兵(sentinel)/4.哨兵监控节点异常.md","headers":[],"categoryList":[{"id":"3c4c90","sort":10002,"name":"study-notes"},{"id":"fe643d","sort":10003,"name":"back-end"},{"id":"46b09b","sort":10033,"name":"redis"},{"id":"a9eb91","sort":9,"name":"Redis哨兵(sentinel)"}]}');export{u as comp,y as data};

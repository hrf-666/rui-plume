import{_ as a,c as e,b as t,o as r}from"./app-BxaswAnj.js";const n="/rui-plume/assets/32.6387%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6--1MIkrxf.png",m="/rui-plume/assets/33.%E6%96%B0%E8%8A%82%E7%82%B9%E5%8A%A0%E5%85%A5%E9%9B%86%E7%BE%A4master-DcY_EZhl.png",i="/rui-plume/assets/34.%E5%8A%A0%E5%85%A5%E5%90%8E%E9%9B%86%E7%BE%A4%E6%83%85%E5%86%B5-Be0-8PRm.png",l="/rui-plume/assets/35.%E5%88%86%E9%85%8D%E6%A7%BD%E4%BD%8D1-CQYbcj6y.png",p="/rui-plume/assets/36.%E5%88%86%E9%85%8D%E6%A7%BD%E4%BD%8D2-C4EXdyfg.png",c="/rui-plume/assets/37.%E9%9B%86%E7%BE%A4%E6%83%85%E5%86%B5%E6%9F%A5%E7%9C%8B-CeOGyWDQ.png",o="/rui-plume/assets/38.%E6%A7%BD%E5%8F%B7%E5%88%86%E9%85%8D%E8%AF%B4%E6%98%8E-lW2y1C-L.png",d="/rui-plume/assets/38.%E4%B8%BA%E4%B8%BB%E6%9C%BA%E5%88%86%E9%85%8D%E4%BB%8E%E8%8A%82%E7%82%B9-DbRmqehh.png",h="/rui-plume/assets/40.%E9%9B%86%E7%BE%A4%E6%83%85%E5%86%B5%E7%AC%AC%E4%B8%89%E6%AC%A1%E6%9F%A5%E7%9C%8B-BiXdZfCS.png",g={};function u(y,s){return r(),e("div",null,[...s[0]||(s[0]=[t('<h1 id="主从扩容案例" tabindex="-1"><a class="header-anchor" href="#主从扩容案例"><span>主从扩容案例</span></a></h1><h3 id="新建6387、6388两个服务实例配置文件-新建后启动" tabindex="-1"><a class="header-anchor" href="#新建6387、6388两个服务实例配置文件-新建后启动"><span>新建6387、6388两个服务实例配置文件+新建后启动</span></a></h3><p>IP：192.168.11.174+端口6387/端口6388</p><p>vim /myredis/cluster/redisCluster6387.conf</p><p><img src="'+n+'" alt=""></p><p>vim /myredis/cluster/redisCluster6388.conf</p><h3 id="启动87-88两个新的节点实例-此时他们自己都是master" tabindex="-1"><a class="header-anchor" href="#启动87-88两个新的节点实例-此时他们自己都是master"><span>启动87/88两个新的节点实例，此时他们自己都是master</span></a></h3><p>redis-server /myredis/cluster/redisCluster6387.conf</p><p>redis-server /myredis/cluster/redisCluster6388.conf</p><h3 id="将新增的6387节点-空槽位-作为master节点加入集群" tabindex="-1"><a class="header-anchor" href="#将新增的6387节点-空槽位-作为master节点加入集群"><span>将新增的6387节点(空槽位)作为master节点加入集群</span></a></h3><p>将新增的6387作为master节点加入原有集群</p><p>redis-cli -a 密码 --cluster <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mstyle mathsize="1.2em"><mi>a</mi><mi>d</mi><mi>d</mi><mo>−</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\textcolor{red}{\\large add-node}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9333em;vertical-align:-0.1em;"></span><span class="mord mathnormal sizing reset-size6 size7" style="color:red;">a</span><span class="mord mathnormal sizing reset-size6 size7" style="color:red;">dd</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin sizing reset-size6 size7" style="color:red;">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;"></span><span class="mord mathnormal sizing reset-size6 size7" style="color:red;">n</span><span class="mord mathnormal sizing reset-size6 size7" style="color:red;">o</span><span class="mord mathnormal sizing reset-size6 size7" style="color:red;">d</span><span class="mord mathnormal sizing reset-size6 size7" style="color:red;">e</span></span></span></span> 自己实际IP地址:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="blue"><mstyle mathsize="1.2em"><mn>6387</mn></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\textcolor{blue}{\\large 6387}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7733em;"></span><span class="mord sizing reset-size6 size7" style="color:blue;">6387</span></span></span></span> 自己实际IP地址:<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mstyle mathsize="1.2em"><mn>6381</mn></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\textcolor{red}{\\large 6381}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7733em;"></span><span class="mord sizing reset-size6 size7" style="color:red;">6381</span></span></span></span></p><p>6387就是将要作为master新增节点 6381 就是原来集群节点里面的领路人，相当于6387拜拜6381的码头从而找到组织加入集群redis-cli -a 123456 --cluster add-node 192.168.111.174:6387 192.168.111.175:6381</p><p><img src="'+m+'" alt=""></p><h3 id="检查集群情况第一次" tabindex="-1"><a class="header-anchor" href="#检查集群情况第一次"><span>检查集群情况第一次</span></a></h3><p>redis-cli -a 密码 --cluster check 真实ip地址:6381</p><p>例如：redis-cli -a 123456 --cluster check 192.168.111.175:6381</p><p><img src="'+i+'" alt=""></p><h3 id="重新分派槽位" tabindex="-1"><a class="header-anchor" href="#重新分派槽位"><span>重新分派槽位( <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mstyle mathsize="1.2em"><mi>r</mi><mi>e</mi><mi>s</mi><mi>h</mi><mi>a</mi><mi>r</mi><mi>d</mi></mstyle></mstyle></mrow><annotation encoding="application/x-tex">\\textcolor{red}{\\large reshard}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;"></span><span class="mord mathnormal sizing reset-size6 size7" style="color:red;">res</span><span class="mord mathnormal sizing reset-size6 size7" style="color:red;">ha</span><span class="mord mathnormal sizing reset-size6 size7" style="margin-right:0.02778em;color:red;">r</span><span class="mord mathnormal sizing reset-size6 size7" style="color:red;">d</span></span></span></span>)</span></a></h3><p>重新分派槽号 命令:redis-cli -a 密码 --cluster reshard IP地址:端口号</p><p>redis-cli -a 123456 --cluster reshard 192.168.111.175:6381</p><p><img src="'+l+'" alt=""></p><p><img src="'+p+'" alt=""></p><h3 id="检查集群情况第二次" tabindex="-1"><a class="header-anchor" href="#检查集群情况第二次"><span>检查集群情况第二次</span></a></h3><p>redis-cli --cluster check 真实IP地址：6381</p><p>redis-cli --cluster check 192.168.111.175:6381</p><p><img src="'+c+'" alt=""></p><p><strong>槽位分派说明</strong></p><p>为什么6387是3个新的区间，以前的还是连续？</p><p>重新分配成本太高，所以前3家各自匀出来一部分，从6381/6383/6385三个旧节点分别匀出1367个坑位给信节点6387</p><p><img src="'+o+'" alt=""></p><h3 id="为主节点6387分配从节点6388" tabindex="-1"><a class="header-anchor" href="#为主节点6387分配从节点6388"><span>为主节点6387分配从节点6388</span></a></h3><p>命令：redis-cli -a 密码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mo>−</mo><mo>−</mo><mi>c</mi><mi>l</mi><mi>u</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>r</mi><mtext> </mtext><mi>a</mi><mi>d</mi><mi>d</mi><mo>−</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi></mstyle></mrow><annotation encoding="application/x-tex">\\textcolor{red}{ --cluster \\ add-node}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em;"></span><span class="mord" style="color:red;">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:red;">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="color:red;">c</span><span class="mord mathnormal" style="margin-right:0.01968em;color:red;">l</span><span class="mord mathnormal" style="color:red;">u</span><span class="mord mathnormal" style="color:red;">s</span><span class="mord mathnormal" style="color:red;">t</span><span class="mord mathnormal" style="margin-right:0.02778em;color:red;">er</span><span class="mspace" style="color:red;"><span style="color:red;"> </span></span><span class="mord mathnormal" style="color:red;">a</span><span class="mord mathnormal" style="color:red;">dd</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin" style="color:red;">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="color:red;">n</span><span class="mord mathnormal" style="color:red;">o</span><span class="mord mathnormal" style="color:red;">d</span><span class="mord mathnormal" style="color:red;">e</span></span></span></span> ip:新slave端口 IP :新master端口 --cluster-slave --cluster-master-id 新主机节ID redis-cli -a 111111 --cluster add-node 192.168.111.174:6388 192.168.111.174:6387 --cluster-slave --cluster-master-id 4feb6a7ee0ed2b39f86474cf4189ab2a554a40f-------这个是6387的编号，按照自己实际情况</p><p><img src="'+d+'" alt=""></p><h3 id="检查集群情况第三次" tabindex="-1"><a class="header-anchor" href="#检查集群情况第三次"><span>检查集群情况第三次</span></a></h3><p>redis-cli --cluster check 真实IP地址：6381</p><p>redis-cli --cluster check 192.168.111.175:6381</p><p><img src="'+h+'" alt=""></p>',38)])])}const x=a(g,[["render",u]]),z=JSON.parse('{"path":"/article/nrvnaocy/","title":"7.主从扩容案例","lang":"zh-CN","frontmatter":{"title":"7.主从扩容案例","createTime":"2025/08/25 22:29:43","permalink":"/article/nrvnaocy/","watermark":true},"readingTime":{"minutes":1.79,"words":538},"git":{"createdTime":1756136329000,"updatedTime":1756136329000,"contributors":[{"name":"HRF","username":"HRF","email":"3398775460@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/HRF?v=4","url":"https://github.com/HRF"}]},"filePathRelative":"study-notes/back-end/redis/10.Redis集群(cluster)/7.主从扩容案例.md","headers":[],"categoryList":[{"id":"3c4c90","sort":10002,"name":"study-notes"},{"id":"fe643d","sort":10003,"name":"back-end"},{"id":"46b09b","sort":10033,"name":"redis"},{"id":"9fbdec","sort":10,"name":"Redis集群(cluster)"}]}');export{x as comp,z as data};
